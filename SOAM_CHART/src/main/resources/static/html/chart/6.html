<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<script src="/chart/js/echarts.common.min.js"></script>
<script src="/chart/resource/jquery/3.1.0/jquery-3.1.0.min.js"></script>
<script src="/chart/js/constants.js" type="text/javascript"></script>
</head>
<body>
	<!-- 为 ECharts 准备一个具备大小（宽高）的 DOM -->
	<div id="main" style="width: 100%; height: 700px;"></div>
	<script type="text/javascript">
		// 基于准备好的dom，初始化echarts实例
		// 基于准备好的dom，初始化echarts实例
		var div = document.getElementById('main');
		//用于使chart自适应高度和宽度,通过窗体高宽计算容器高宽
		var resizeWorldMapContainer = function () {
			div.style.width = window.innerWidth - 50 +'px';
			div.style.height = window.innerHeight - 50 +'px';
		};
		resizeWorldMapContainer();
		var myChart = echarts.init(div);
		$.ajax({
			type : "POST",
			url : "/chart/chart/statisticsErrorType/",
			contentType : "application/json",
			dataType : "json",
			beforeSend : function(XHR) {
				myChart.showLoading();
			},
			complete : function(XHR, status) {
				myChart.hideLoading();
			},
			success : function(data) {
				option = {
					    tooltip: {
					        trigger: 'item',
					        formatter: "{a} <br/>{b}: {c} ({d}%)"
					    },
					    title : {
					        text: '请求失败类型',
					        x:'center'
					    },
					    legend: {
					        orient: 'vertical',
					        x: 'left',
					        data:['网络','程序','数据','其它']
					    },
					    series: [
					        {
					            name:'请求失败类型',
					            type:'pie',
					            radius: ['50%', '70%'],
					            avoidLabelOverlap: false,
					            label: {
					                normal: {
					                    show: false,
					                    position: 'center'
					                },
					                emphasis: {
					                    show: true,
					                    textStyle: {
					                        fontSize: '30',
					                        fontWeight: 'bold'
					                    }
					                }
					            },
					            labelLine: {
					                normal: {
					                    show: false
					                }
					            },
					            data:data.body.counts
					        }
					    ]
					};
				
				myChart.setOption(option);
			}
		});
		
		//用于使chart自适应高度和宽度
		window.onresize = function () {
		    //重置容器高宽
		    resizeWorldMapContainer();
		    myChart.resize();
		};
	</script>
</body>
</html>